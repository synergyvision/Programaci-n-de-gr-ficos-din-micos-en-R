---
title: "Programación y elaboración de gráficos en R"
author: "Freddy F. Tapia C."
output:
  html_document:
    self_contained: false
---

```{r, include=FALSE}
tutorial::go_interactive()
```

## <span style="color:navy"> **_Construción de gráficos usando librería base_** </span>

### Definir data a graficar

```{r ex="create_a", type="pre-exercise-code"}
#x <- seq(-5*pi,5*pi,length=100)

#y <- cos(x)

```

```{r ex="create_a", type="sample-code"}
# Definir variable x, como una secuencia de 100 valores entre -5*pi y 5*pi 



# Definir variable y, como el coseno del vector anterior



# Crear un grafico de líneas, de color verde y de anchura de línea 4






```

```{r ex="create_a", type="solution"}
#x
x <- seq(-5*pi,5*pi,length=100)

#y
y <- cos(x)

# Grafica la función
a <- plot(x,y,type = "l",col="green",lwd=4)
a
```

```{r ex="create_a", type="sct"}
test_object("a")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Construir un gráfico sencillo

```{r ex="create_b", type="pre-exercise-code"}
x <- seq(-5*pi,5*pi,length=100)

y <- cos(x)

```

```{r ex="create_b", type="sample-code"}
# A partir del grafico anterior, agregar título, subtítulo y nombre de ejes
b=plot(x,y,type = "l",col="green",lwd=4,main=___,sub =___ ,xlab =___ ,ylab =___ )

# Crear un gráfico de color morado, y de titulo "Función Coseno"


# Crear un gráfico de color rojo y con un grosor de línea de 5


```

```{r ex="create_b", type="solution"}
b <- plot(x,y,type = "l",col="green",lwd=4,main="Coseno",sub ="Grafico 1" ,xlab = "eje x" ,ylab = "eje y" )
b

b1 <- plot(x,y,type = "l",col="purple",lwd=4,main="Función Coseno")
b1

b2 <- plot(x,y,type = "l",col="red",lwd=5)
b2
```

```{r ex="create_b", type="sct"}
test_object("b")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Construir diferentes tipos de gráficos (1)

```{r ex="create_c", type="pre-exercise-code"}
x <- seq(-5*pi,5*pi,length=100)

y <- cos(x)

```

```{r ex="create_c", type="sample-code"}
# A partir de la data anterior, generar un grafico de puntos
b1=plot(x,y,type = "-",col="green",lwd=4)

# Generar un grafico de líneas + puntos
b2=plot(x,y,type = "-",col="green",lwd=4)

# Generar un grafico de líneas sin puntos
b3=plot(x,y,type = "-",col="green",lwd=4)

# Generar un grafico usando argunmeto "o"
b4=plot(x,y,type = "-",col="green",lwd=4)


```

```{r ex="create_c", type="solution"}
# Generar un grafico de puntos
b1=plot(x,y,type = "p",col="green",lwd=4)

# Generar un grafico de líneas + puntos
b2=plot(x,y,type = "b",col="green",lwd=4)

# Generar un grafico de líneas sin puntos
b3=plot(x,y,type = "c",col="green",lwd=4)

# Generar un grafico usando argunmeto "o"
b4=plot(x,y,type = "o",col="green",lwd=4)
```

### Construir diferentes tipos de gráficos (2)

```{r ex="create_d", type="pre-exercise-code"}
x <- seq(-5*pi,5*pi,length=100)

y <- cos(x)

```

```{r ex="create_d", type="sample-code"}
# Generar un grafico usando argunmeto "h"
c1=plot(x,y,type = "-",col="green",lwd=4)

# Generar un grafico usando argunmeto "s"
c2=plot(x,y,type = "-",col="green",lwd=4)

# Generar un grafico usando argunmeto "S"
c3=plot(x,y,type = "-",col="green",lwd=4)

# Generar un grafico usando argunmeto "n"
c4=plot(x,y,type = "-",col="green",lwd=4)


```

```{r ex="create_d", type="solution"}
# Generar un grafico usando argunmeto "h"
c1=plot(x,y,type = "h",col="green",lwd=4)

# Generar un grafico usando argunmeto "s"
c2=plot(x,y,type = "s",col="green",lwd=4)

# Generar un grafico usando argunmeto "S"
c3=plot(x,y,type = "S",col="green",lwd=4)

# Generar un grafico usando argunmeto "n"
c4=plot(x,y,type = "n",col="green",lwd=4)
```

```{r ex="create_d", type="sct"}
test_object("c1")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Uso de argumentos en la construcción de un gráfico

```{r ex="create_e", type="pre-exercise-code"}
x <- seq(-5*pi,5*pi,length=100)

y <- cos(x)

```

```{r ex="create_e", type="sample-code"}
# Generar un grafico usando asp = 0.2
d1=plot(x,y,type = "l",col="green",lwd=4,asp=___)

# Generar un grafico usando asp = 1
d1=plot(x,y,type = "l",col="green",lwd=4,asp=___)

# Generar un grafico usando asp = 3
d1=plot(x,y,type = "l",col="green",lwd=4,asp=___)



```

```{r ex="create_e", type="solution"}
# Generar un grafico usando asp = 0.2
d1=plot(x,y,type = "l",col="green",lwd=4,asp=0.2)

# Generar un grafico usando asp = 1
d1=plot(x,y,type = "l",col="green",lwd=4,asp=1)

# Generar un grafico usando asp = 3
d1=plot(x,y,type = "l",col="green",lwd=4,asp=3)
```

```{r ex="create_e", type="sct"}
test_object("d1")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Histogramas

```{r ex="create_e1", type="pre-exercise-code"}
#x <- seq(-5*pi,5*pi,length=100)

#y <- cos(x)

```

```{r ex="create_e1", type="sample-code"}
# Generar un histograma simple con 1000 numero aleatorios normales de varianza 1 y media 0
a <- hist(rnorm(___,___,___))

# Generar un histograma simple con 1000 numero aleatorios normales de varianza 1 y media 0, usando 20 clases (breaks)
b <- hist(rnorm(___,___,___),breaks=___)

# Generar un histograma simple con 1000 numero aleatorios normales de varianza 1 y media 0, usando 20 clases (breaks), de color gris, con un titulo = "Histograma", y nombre de ejes: eje x= "Números aleatorios", eje y= "Frecuencia"
c <- hist(rnorm(___,___,___),breaks=___,col=___,
      xlab=___, ylab=___,main=___)


```

```{r ex="create_e1", type="solution"}
# Generar un histograma simple con 1000 numero aleatorios normales de varianza 1 y media 0
a <- hist(rnorm(1000,0,1))

# Generar un histograma simple con 1000 numero aleatorios normales de varianza 1 y media 0, usando 20 clases (breaks)
b <- hist(rnorm(1000,0,1),breaks=20)

# Generar un histograma simple con 1000 numero aleatorios normales de varianza 1 y media 0, usando 20 clases (breaks), de color gris, con un titulo = "Histograma", y nombre de ejes: eje x= "Números aleatorios", eje y= "Frecuencia"
c <- hist(rnorm(1000,0,1),breaks=20,col="grey",
      xlab="Números aleatorios", ylab="Frecuencia",main="Histograma")

```

```{r ex="create_e1", type="sct"}
test_object("a")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Boxplots

```{r ex="create_e2", type="pre-exercise-code"}
library(ggplot2)
data(mpg)

```

```{r ex="create_e2", type="sample-code"}
# Generar boxplot simple usando las columnas 3, 8 y 9 de la data mpg
a=boxplot(___)

# Generar boxplot simple horizontal usando las columnas 3, 8 y 9 de la data mpg
b=boxplot(___,horizontal = ___)

# Generar boxplot simple  usando las columnas 3, 8 y 9 de la data mpg, usando los colores azul, verde y rojo para cada variable
c=boxplot(___, border = c(___, ___, ___))


```

```{r ex="create_e2", type="solution"}
# Generar boxplot simple usando las columnas 3, 8 y 9 de la data mpg
a=boxplot(mpg[,c(3,8,9)])

# Generar boxplot simple horizontal usando las columnas 3, 8 y 9 de la data mpg
b=boxplot(mpg[,c(3,8,9)],horizontal = TRUE)

# Generar boxplot simple  usando las columnas 3, 8 y 9 de la data mpg, usando los colores azul, verde y rojo para cada variable
c=boxplot(mpg[,c(3,8,9)], border = c("blue", "green", "red"))
```

```{r ex="create_e2", type="sct"}
test_object("a")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```



## <span style="color:navy"> **_Construción de gráficos usando paquete ggplot2_** </span>

### Generar un gráfico usando ggplot

```{r ex="create_f", type="pre-exercise-code"}
library(ggplot2)

x <- seq(-5*pi,5*pi,length=100)

y <- cos(x)

```

```{r ex="create_f", type="sample-code"}
# Generar un grafico forma 1

# Generar un grafico forma 2

# Generar un grafico forma 3



```

```{r ex="create_f", type="solution"}
# Generar un grafico forma 1
a1=ggplot(data=data.frame(x,y), aes(x, y)) + geom_line(color="blue")
a1

# Generar un grafico forma 2
a2=ggplot(data=data.frame(x,y)) + geom_line( aes(x, y),color="green")
a2

# Generar un grafico forma 3
a3=ggplot() + geom_line(data=data.frame(x,y),aes(x, y),color="brown")
a3

```

```{r ex="create_f", type="sct"}
#test_object("a1")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Usos de Geoms y estéticas (1)

```{r ex="create_g", type="pre-exercise-code"}
library(ggplot2)


```

```{r ex="create_g", type="sample-code"}
# Generar un grafico de área

# Generar un grafico de puntos

# Generar un Histograma

# Un grafico de barras


```

```{r ex="create_g", type="solution"}
# Generar un grafico de área
a <- ggplot(mpg, aes(hwy))

a+geom_area(stat = "bin",color="blue",fill="green")

# Generar un grafico de puntos
a + geom_dotplot()

# Generar un Histograma
a + geom_histogram(binwidth = 5)

# Un grafico de barras
b <- ggplot(mpg, aes(fl))

b + geom_bar()



```

```{r ex="create_g", type="sct"}
#test_object("a1")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Usos de Geoms y estéticas (2)

```{r ex="create_h", type="pre-exercise-code"}
library(ggplot2)


```

```{r ex="create_h", type="sample-code"}
# Generar un grafico de path

# Generar un grafico de ribbon

# Generar un jitter

# Un grafico de point


```

```{r ex="create_h", type="solution"}
# Generar un grafico de path
d <- ggplot(economics,aes(date,unemploy))
d+geom_path(lineend = "butt",linejoin = "round",linemitre = 1)

# Generar un grafico de ribbon
d+geom_ribbon(aes(ymin=unemploy-900,ymax=unemploy+900))

# Generar un jitter
f <- ggplot(mpg, aes(cty, hwy))
f+ geom_jitter()

# Un grafico de point
f+ geom_point()

```

```{r ex="create_h", type="sct"}
#test_object("a1")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Usos de Geoms y estéticas (3)

```{r ex="create_i", type="pre-exercise-code"}
library(ggplot2)


```

```{r ex="create_i", type="sample-code"}
# Generar un grafico de smoth

# Generar un grafico de text

# Generar un boxplot

# Un grafico de line

# Un grafico de geom map


```

```{r ex="create_i", type="solution"}
# Generar un grafico de smoth
f <- ggplot(mpg, aes(cty, hwy))
f+ geom_smooth()

# Generar un grafico de text
f+ geom_text(aes(label = cty))

# Generar un boxplot
g <- ggplot(mpg,aes(class,hwy))
g+geom_boxplot()

# Un grafico de line
j <- ggplot(economics,aes(date, unemploy))
j+geom_line()

# Un grafico de geom map
data <- data.frame(murder=USArrests$Murder,state=tolower(rownames(USArrests)))
map=map_data("state")
l <- ggplot(data,aes(fill=murder))
l+geom_map(aes(map_id=state),map=map)+expand_limits(x=map$long,y=map$lat)


```

```{r ex="create_i", type="sct"}
#test_object("a1")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Uso de Stats

```{r ex="create_j", type="pre-exercise-code"}
library(ggplot2)


```

```{r ex="create_j", type="sample-code"}
# Generar un grafico de stat_bin

# Generar un grafico de stat_bin2d

# Generar un grafico de stat_contour

# Generar un grafico de stat_boxplot



```

```{r ex="create_j", type="solution"}
# Generar un grafico de stat_bin
a <- ggplot(mpg, aes(hwy))
a+stat_bin(binwidth = 1,origin=10)

# Generar un grafico de stat_bin2d
f <- ggplot(mpg, aes(cty, hwy))
f + stat_bin2d(bins = 30, drop = TRUE)

# Generar un grafico de stat_contour
m <- ggplot(seals,aes(long,lat))
m + stat_contour(aes(z = delta_lat))

# Generar un grafico de stat_boxplot
g <- ggplot(mpg,aes(class,hwy))
g + stat_boxplot(coef = 1.5)


```

```{r ex="create_j", type="sct"}
#test_object("a1")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Escalas

```{r ex="create_k", type="pre-exercise-code"}
library(ggplot2)


```

```{r ex="create_k", type="sample-code"}
# Generar un grafico de scale_fill_manual

# Generar un grafico de scale_x_date (1)

# Generar un grafico de scale_x_date (2)

# Generar un grafico de scale_x_date (3)

# Generar un grafico de scale_x_date (4)

# Generar un grafico de scale_x_date (5)

```

```{r ex="create_k", type="solution"}
# Generar un grafico de scale_fill_manual
b <- ggplot(mpg, aes(fl))
n <- b + geom_bar(aes(fill = fl))

n + scale_fill_manual(
  values = c("skyblue", "royalblue", "blue", "navy"), limits = c("d", "e", "p", "r"), breaks =c("d", "e", "p", "r"), name = "fuel", labels = c("D", "E", "P", "R"))

# Generar un grafico de scale_x_date (1)
last_month <- Sys.Date() - 0:29
df <- data.frame(
  date = last_month,
  price = runif(30)
)
base <- ggplot(df, aes(date, price)) +
  geom_line()

base + scale_x_date(date_labels = "%Y %m %d")

# Generar un grafico de scale_x_date (2)
base + scale_x_date(date_labels = "%b %d")

# Generar un grafico de scale_x_date (3)
base + scale_x_date(date_breaks = "1 week", date_labels = "%W")

# Generar un grafico de scale_x_date (4)
base + scale_x_date(date_minor_breaks = "1 day")

# Generar un grafico de scale_x_date (5)
base + scale_x_date(limits = c(Sys.Date() - 7, NA))

```

```{r ex="create_k", type="sct"}
#test_object("a1")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Sistemas de coordenadas


```{r ex="create_l", type="pre-exercise-code"}
library(ggplot2)


```

```{r ex="create_l", type="sample-code"}
# Generar un grafico de coord_cartesian

# Generar un grafico de coord_fixed 

# Generar un grafico de coord_flip

# Generar un grafico de coord_polar

# Generar un grafico de coord_trans

# Generar un grafico de coord_map

```

```{r ex="create_l", type="solution"}
# Generar un grafico de coord_cartesian
b <- ggplot(mpg, aes(fl))
r <- b + geom_bar()
r + coord_cartesian(xlim = c(0, 5))


# Generar un grafico de coord_fixed 
r + coord_fixed(ratio = 1/5)

# Generar un grafico de coord_flip
r + coord_flip()

# Generar un grafico de coord_polar
r + coord_polar(theta = "x", direction=1 )

# Generar un grafico de coord_trans
r + coord_trans(y = "sqrt")

# Generar un grafico de coord_map
r + coord_map(projection = "ortho",
              orientation=c(41, -74, 0))

```

```{r ex="create_l", type="sct"}
#test_object("a1")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Ajuste de posición y temas

```{r ex="create_m", type="pre-exercise-code"}
library(ggplot2)


```

```{r ex="create_m", type="sample-code"}
# Generar un grafico de dodge

# Generar un grafico de fill

# Generar un grafico de stack

# Generar un grafico de theme_bw

# Generar un grafico de theme_grey

# Generar un grafico de theme_void

```

```{r ex="create_m", type="solution"}
# Generar un grafico de dodge
s <- ggplot(mpg,aes(fl,fill=drv))
s + geom_bar(position = "dodge")

# Generar un grafico de fill
s + geom_bar(position = "fill")

# Generar un grafico de stack
s + geom_bar(position = "stack")

# Generar un grafico de theme_bw
b <- ggplot(mpg, aes(fl))
r <- b + geom_bar()

r +theme_bw()

# Generar un grafico de theme_grey
r+theme_grey()

# Generar un grafico de theme_void
r+theme_void()

```

```{r ex="create_m", type="sct"}
#test_object("a1")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Faceting y labels

```{r ex="create_n", type="pre-exercise-code"}
library(ggplot2)


```

```{r ex="create_n", type="sample-code"}
# Generar un grafico de facet_grid (1)

# Generar un grafico de facet_grid (2)

# Generar un grafico de facet_grid (3)

# Generar un grafico de labels (1)

# Generar un grafico de labels (2)


```

```{r ex="create_n", type="solution"}
# Generar un grafico de facet_grid (1)
t <- ggplot(mpg,aes(cty,hwy)) + geom_point()

t + facet_grid(. ~ fl)

# Generar un grafico de facet_grid (2)
t + facet_grid(year ~ .)

# Generar un grafico de facet_grid (3)
t + facet_grid(year ~ fl)

# Generar un grafico de labels (1)
t + ggtitle("New Plot Title")+xlab("New X label")+ylab("New Y label")

# Generar un grafico de labels (2)
t + labs(title =" New title", x = "New x", y = "New y")

```

```{r ex="create_n", type="sct"}
#test_object("a1")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Legend y zooming

```{r ex="create_o", type="pre-exercise-code"}
library(ggplot2)


```

```{r ex="create_o", type="sample-code"}
# Generar un grafico de legend (1)

# Generar un grafico de legend (2)

# Generar un grafico de legend (3)

# Generar un grafico de zoom (1)

# Generar un grafico de zoom (2)

# Generar un grafico de zoom (3)


```

```{r ex="create_o", type="solution"}
# Generar un grafico de legend (1)
ToothGrowth$dose <- as.factor(ToothGrowth$dose)
p <- ggplot(ToothGrowth, aes(x=dose, y=len, fill=dose)) + 
  geom_boxplot()
p + theme(legend.position="bottom")

# Generar un grafico de legend (2)
p + theme(legend.text = element_text(colour="blue", size=10, 
                                     face="bold"))

# Generar un grafico de legend (3)
p + theme(legend.background = element_rect(fill="lightblue",
                                  size=0.5, linetype="solid", 
                                  colour ="darkblue"))

# Generar un grafico de zoom (1)
t <- ggplot(mpg,aes(cty,hwy)) + geom_point()

t + coord_cartesian(
  xlim = c(0, 100), ylim = c(10, 20))

# Generar un grafico de zoom (2)
t + ylim(10, 20)

# Generar un grafico de zoom (3)
t + scale_x_continuous(limits = c(0, 100)) +
  scale_y_continuous(limits = c(0, 100))

```

```{r ex="create_o", type="sct"}
#test_object("a1")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```


## <span style="color:navy"> **_Construción de gráficos dinámicos_** </span>

### HTML Widgets (1)

```{r ex="create_p", type="pre-exercise-code"}
library(ggplot2)
library(magrittr)
#library(leaflet) #
#library(dygraphs) #
library(plotly)
#library(rbokeh) #


```

```{r ex="create_p", type="sample-code"}
# Generar un grafico usando paquete leaflet

# Generar un grafico usando paquete dygraphs

# Generar un grafico usando paquete plotly

# Generar un grafico usando paquete rbokeh


```

```{r ex="create_p", type="solution"}
# Generar un grafico usando paquete leaflet
# rand_lng <- function(n = 10) rnorm(n, -93.65, .01)
# rand_lat <- function(n = 10) rnorm(n, 42.0285, .01)
# 
# categories <- LETTERS[1:10]
# df <- data.frame(
#   lat = rand_lat(100), lng = rand_lng(100), size = runif(100, 5, 20),
#   category = factor(sample(categories, 100, replace = TRUE), levels = categories),
#   value = rnorm(100)
# )
# m <- leaflet(df) %>% addTiles()
# m %>% addCircleMarkers(~lng, ~lat, radius = ~size)
# m %>% addCircleMarkers(~lng, ~lat, radius = runif(100, 4, 10), color = c("red"))

# Generar un grafico usando paquete dygraphs
# dygraph(nhtemp, main = "New Haven Temperatures") %>% 
#   dyRangeSelector(dateWindow = c("1920-01-01", "1960-01-01"))


# Generar un grafico usando paquete plotly
p <- ggplot(data = diamonds, aes(x = cut, fill = clarity)) 
+ geom_bar(position = "dodge")

ggplotly(p)


# Generar un grafico usando paquete rbokeh
# figure() %>%
#   ly_points(Sepal.Length, Sepal.Width, data = iris,
#             color = Species, glyph = Species,
#             hover = list(Sepal.Length, Sepal.Width))
# 


```

```{r ex="create_p", type="sct"}
#test_object("a1")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### HTML Widgets (2)

```{r ex="create_q", type="pre-exercise-code"}
library(ggplot2)
library(magrittr)
#library(highcharter) #
#library(networkD3) #
#library(d3heatmap) #
library(DT)
#library(DiagrammeR) #


```

```{r ex="create_q", type="sample-code"}
# Generar un grafico usando paquete highcharter

# Generar un grafico usando paquete networkD3

# Generar un grafico usando paquete d3heatmap

# Generar un grafico usando paquete DT

# Generar un grafico usando paquete DiagrammeR


```

```{r ex="create_q", type="solution"}
# Generar un grafico usando paquete highcharter
# highchart() %>% 
#   hc_title(text = "Scatter chart with size and color") %>% 
#   hc_add_series_scatter(mtcars$wt, mtcars$mpg,
#                         mtcars$drat, mtcars$hp)

# Generar un grafico usando paquete networkD3
# data(MisLinks, MisNodes)
# forceNetwork(Links = MisLinks, Nodes = MisNodes, Source = "source",
#              Target = "target", Value = "value", NodeID = "name",
#              Group = "group", opacity = 0.4)

# Generar un grafico usando paquete d3heatmap
# d3heatmap(mtcars, scale="column", colors="Blues")

# Generar un grafico usando paquete DT
datatable(iris, options = list(pageLength = 5))

# Generar un grafico usando paquete DiagrammeR
# grViz("
#       digraph {
#       layout = twopi
#       node [shape = circle]
#       A -> {B C D} 
#       }")


```

```{r ex="create_q", type="sct"}
#test_object("a1")
#test_output_contains("x", incorrect_msg = "Make sure to print `x`.")
success_msg("Bien hecho!")
```

### Paquete Ploty (1)

### Paquete Ploty (2)

### Paquete Dygraphs

### Grobs y Viewports

### Paquete GridExtra




## <span style="color:navy"> **_Creación de nuevas estructuras gráficas_** </span>